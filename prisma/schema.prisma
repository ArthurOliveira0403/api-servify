generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      =  env("DATABASE_URL")
}

model Address {
  company_id String  @unique
  country    String?
  state      String?
  city       String?
  street     String?
  number     String?
  zip_code   String?
  complement String?

  company Company @relation(fields: [company_id], references: [id], onDelete: Cascade)

  @@map("address")
}

model Company {
  id              String   @id @default(uuid())
  name            String?
  email           String   @unique 
  password        String   
  cnpj            String?  @unique
  address         Address?
  phone_number    String?
  logo_url        String? 
  role            UserRole @default(COMPANY)
  created_at      DateTime @default(now())
  updated_at      DateTime @updatedAt
  
  subscriptions Subscription[]
  @@map("company")
}

enum SubscriptionStatus {
  ACTIVE
  CANCELED
  EXPIRED
}

model Subscription {
  id           String             @id @default(uuid())
  company_id   String          
  plan_id      String
  price        Int
  status       SubscriptionStatus
  start_date   DateTime
  end_date     DateTime
  renewal_date DateTime

  company Company @relation(fields: [company_id], references: [id], onDelete: Cascade)
  plan Plan @relation(fields: [plan_id], references: [id], onDelete: Cascade)
  @@map("subscription")
}

enum PlanType {
  MONTHLY
  YEARLY
}

model Plan {
  id            String         @id
  name          String         @unique
  type          PlanType
  price         Int
  description   String
  subscriptions Subscription[]

  @@map("plan")
}

enum UserRole {
  ADMIN
  COMPANY
}

model Admin {
  id       String   @id @default(uuid())
  email    String   @unique
  password String
  role     UserRole @default(ADMIN)

  @@map("admin")
}